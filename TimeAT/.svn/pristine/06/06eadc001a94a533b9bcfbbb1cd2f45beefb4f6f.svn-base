Imports System.Data
Imports System.Data.SqlClient

Public Class frmTimeKa
    Inherits System.Windows.Forms.Form

#Region " Windows Form Designer generated code "

    Public Sub New()
        MyBase.New()

        'This call is required by the Windows Form Designer.
        InitializeComponent()

        'Add any initialization after the InitializeComponent() call

    End Sub

    'Form overrides dispose to clean up the component list.
    Protected Overloads Overrides Sub Dispose(ByVal disposing As Boolean)
        If disposing Then
            If Not (components Is Nothing) Then
                components.Dispose()
            End If
        End If
        MyBase.Dispose(disposing)
    End Sub

    'Required by the Windows Form Designer
    Private components As System.ComponentModel.IContainer

    'NOTE: The following procedure is required by the Windows Form Designer
    'It can be modified using the Windows Form Designer.  
    'Do not modify it using the code editor.
    Friend WithEvents Label1 As System.Windows.Forms.Label
    Friend WithEvents Label2 As System.Windows.Forms.Label
    Friend WithEvents btnAdd As System.Windows.Forms.Button
    Friend WithEvents btnEdit As System.Windows.Forms.Button
    Friend WithEvents btnDelete As System.Windows.Forms.Button
    Friend WithEvents btnRefresh As System.Windows.Forms.Button
    Friend WithEvents btnExit As System.Windows.Forms.Button
    Friend WithEvents colDeptId As System.Windows.Forms.ColumnHeader
    Friend WithEvents txtGroupId As System.Windows.Forms.TextBox
    Friend WithEvents txtGroupName As System.Windows.Forms.TextBox
    Friend WithEvents lstSubjectGroup As System.Windows.Forms.ListView
    Friend WithEvents colTimeST As System.Windows.Forms.ColumnHeader
    Friend WithEvents colTimeSP As System.Windows.Forms.ColumnHeader
    Friend WithEvents txtTimeST As System.Windows.Forms.MaskedTextBox
    Friend WithEvents Label3 As System.Windows.Forms.Label
    Friend WithEvents Label4 As System.Windows.Forms.Label
    Friend WithEvents txtTimeSP As System.Windows.Forms.MaskedTextBox
    Friend WithEvents Label8 As System.Windows.Forms.Label
    Friend WithEvents GroupBox1 As System.Windows.Forms.GroupBox
    Friend WithEvents chkSunday As System.Windows.Forms.CheckBox
    Friend WithEvents chkSaturday As System.Windows.Forms.CheckBox
    Friend WithEvents chkFriday As System.Windows.Forms.CheckBox
    Friend WithEvents chkThursday As System.Windows.Forms.CheckBox
    Friend WithEvents chkWednesday As System.Windows.Forms.CheckBox
    Friend WithEvents chkTuesday As System.Windows.Forms.CheckBox
    Friend WithEvents chkMonDay As System.Windows.Forms.CheckBox
    Friend WithEvents GroupBox2 As System.Windows.Forms.GroupBox
    Friend WithEvents colMon As System.Windows.Forms.ColumnHeader
    Friend WithEvents colTue As System.Windows.Forms.ColumnHeader
    Friend WithEvents colWed As System.Windows.Forms.ColumnHeader
    Friend WithEvents colThu As System.Windows.Forms.ColumnHeader
    Friend WithEvents colFri As System.Windows.Forms.ColumnHeader
    Friend WithEvents colSat As System.Windows.Forms.ColumnHeader
    Friend WithEvents colSun As System.Windows.Forms.ColumnHeader
    Friend WithEvents txtMidDayStop As System.Windows.Forms.MaskedTextBox
    Friend WithEvents txtMidDayStart As System.Windows.Forms.MaskedTextBox
    Friend WithEvents Label6 As System.Windows.Forms.Label
    Friend WithEvents Label5 As System.Windows.Forms.Label
    Friend WithEvents colRestST As System.Windows.Forms.ColumnHeader
    Friend WithEvents colRestSP As System.Windows.Forms.ColumnHeader
    Friend WithEvents chkMidDayStop_NextDay As System.Windows.Forms.CheckBox
    Friend WithEvents chkTimeSP_NextDay As System.Windows.Forms.CheckBox
    Friend WithEvents chkMidDayStart_NextDay As System.Windows.Forms.CheckBox
    Friend WithEvents colTimeSP_Next As System.Windows.Forms.ColumnHeader
    Friend WithEvents colRestST_NextD As System.Windows.Forms.ColumnHeader
    Friend WithEvents colRestSP_NextD As System.Windows.Forms.ColumnHeader
    Friend WithEvents txtEndDay As System.Windows.Forms.MaskedTextBox
    Friend WithEvents Label7 As System.Windows.Forms.Label
    Friend WithEvents chkTimeEndDay_NextDay As System.Windows.Forms.CheckBox
    Friend WithEvents colTimeEndDay As System.Windows.Forms.ColumnHeader
    Friend WithEvents colTimeEndDay_NextD As System.Windows.Forms.ColumnHeader
    Friend WithEvents GroupBox3 As System.Windows.Forms.GroupBox
    Friend WithEvents Label9 As System.Windows.Forms.Label
    Friend WithEvents txtStartDay As System.Windows.Forms.MaskedTextBox
    Friend WithEvents chkStartDay_PD As System.Windows.Forms.CheckBox
    Friend WithEvents colStartDay As System.Windows.Forms.ColumnHeader
    Friend WithEvents colStartDay_PD As System.Windows.Forms.ColumnHeader
    Friend WithEvents colProgram As System.Windows.Forms.ColumnHeader
    <System.Diagnostics.DebuggerStepThrough()> Private Sub InitializeComponent()
        Me.Label1 = New System.Windows.Forms.Label
        Me.txtGroupId = New System.Windows.Forms.TextBox
        Me.txtGroupName = New System.Windows.Forms.TextBox
        Me.Label2 = New System.Windows.Forms.Label
        Me.lstSubjectGroup = New System.Windows.Forms.ListView
        Me.colDeptId = New System.Windows.Forms.ColumnHeader
        Me.colProgram = New System.Windows.Forms.ColumnHeader
        Me.colTimeST = New System.Windows.Forms.ColumnHeader
        Me.colRestST = New System.Windows.Forms.ColumnHeader
        Me.colRestST_NextD = New System.Windows.Forms.ColumnHeader
        Me.colRestSP = New System.Windows.Forms.ColumnHeader
        Me.colRestSP_NextD = New System.Windows.Forms.ColumnHeader
        Me.colTimeSP = New System.Windows.Forms.ColumnHeader
        Me.colTimeSP_Next = New System.Windows.Forms.ColumnHeader
        Me.colTimeEndDay = New System.Windows.Forms.ColumnHeader
        Me.colTimeEndDay_NextD = New System.Windows.Forms.ColumnHeader
        Me.colMon = New System.Windows.Forms.ColumnHeader
        Me.colTue = New System.Windows.Forms.ColumnHeader
        Me.colWed = New System.Windows.Forms.ColumnHeader
        Me.colThu = New System.Windows.Forms.ColumnHeader
        Me.colFri = New System.Windows.Forms.ColumnHeader
        Me.colSat = New System.Windows.Forms.ColumnHeader
        Me.colSun = New System.Windows.Forms.ColumnHeader
        Me.btnAdd = New System.Windows.Forms.Button
        Me.btnEdit = New System.Windows.Forms.Button
        Me.btnDelete = New System.Windows.Forms.Button
        Me.btnRefresh = New System.Windows.Forms.Button
        Me.btnExit = New System.Windows.Forms.Button
        Me.txtTimeST = New System.Windows.Forms.MaskedTextBox
        Me.Label3 = New System.Windows.Forms.Label
        Me.Label4 = New System.Windows.Forms.Label
        Me.txtTimeSP = New System.Windows.Forms.MaskedTextBox
        Me.Label8 = New System.Windows.Forms.Label
        Me.GroupBox1 = New System.Windows.Forms.GroupBox
        Me.chkSunday = New System.Windows.Forms.CheckBox
        Me.chkSaturday = New System.Windows.Forms.CheckBox
        Me.chkFriday = New System.Windows.Forms.CheckBox
        Me.chkThursday = New System.Windows.Forms.CheckBox
        Me.chkWednesday = New System.Windows.Forms.CheckBox
        Me.chkTuesday = New System.Windows.Forms.CheckBox
        Me.chkMonDay = New System.Windows.Forms.CheckBox
        Me.GroupBox2 = New System.Windows.Forms.GroupBox
        Me.txtEndDay = New System.Windows.Forms.MaskedTextBox
        Me.Label7 = New System.Windows.Forms.Label
        Me.chkMidDayStart_NextDay = New System.Windows.Forms.CheckBox
        Me.chkMidDayStop_NextDay = New System.Windows.Forms.CheckBox
        Me.chkTimeEndDay_NextDay = New System.Windows.Forms.CheckBox
        Me.chkTimeSP_NextDay = New System.Windows.Forms.CheckBox
        Me.txtMidDayStop = New System.Windows.Forms.MaskedTextBox
        Me.txtMidDayStart = New System.Windows.Forms.MaskedTextBox
        Me.Label6 = New System.Windows.Forms.Label
        Me.Label5 = New System.Windows.Forms.Label
        Me.GroupBox3 = New System.Windows.Forms.GroupBox
        Me.chkStartDay_PD = New System.Windows.Forms.CheckBox
        Me.txtStartDay = New System.Windows.Forms.MaskedTextBox
        Me.Label9 = New System.Windows.Forms.Label
        Me.colStartDay = New System.Windows.Forms.ColumnHeader
        Me.colStartDay_PD = New System.Windows.Forms.ColumnHeader
        Me.GroupBox1.SuspendLayout()
        Me.GroupBox2.SuspendLayout()
        Me.GroupBox3.SuspendLayout()
        Me.SuspendLayout()
        '
        'Label1
        '
        Me.Label1.Location = New System.Drawing.Point(27, 6)
        Me.Label1.Name = "Label1"
        Me.Label1.Size = New System.Drawing.Size(83, 16)
        Me.Label1.TabIndex = 0
        Me.Label1.Text = "รหัส : "
        Me.Label1.TextAlign = System.Drawing.ContentAlignment.TopRight
        '
        'txtGroupId
        '
        Me.txtGroupId.Location = New System.Drawing.Point(116, 4)
        Me.txtGroupId.Name = "txtGroupId"
        Me.txtGroupId.Size = New System.Drawing.Size(95, 20)
        Me.txtGroupId.TabIndex = 0
        Me.txtGroupId.Text = "TextBox1"
        '
        'txtGroupName
        '
        Me.txtGroupName.Location = New System.Drawing.Point(116, 27)
        Me.txtGroupName.Name = "txtGroupName"
        Me.txtGroupName.Size = New System.Drawing.Size(231, 20)
        Me.txtGroupName.TabIndex = 1
        Me.txtGroupName.Text = "TextBox1"
        '
        'Label2
        '
        Me.Label2.Location = New System.Drawing.Point(5, 28)
        Me.Label2.Name = "Label2"
        Me.Label2.Size = New System.Drawing.Size(105, 16)
        Me.Label2.TabIndex = 0
        Me.Label2.Text = "ชื่อเวลาการทำงาน : "
        Me.Label2.TextAlign = System.Drawing.ContentAlignment.TopRight
        '
        'lstSubjectGroup
        '
        Me.lstSubjectGroup.Anchor = CType((((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Bottom) _
                    Or System.Windows.Forms.AnchorStyles.Left) _
                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.lstSubjectGroup.Columns.AddRange(New System.Windows.Forms.ColumnHeader() {Me.colDeptId, Me.colProgram, Me.colTimeST, Me.colRestST, Me.colRestST_NextD, Me.colRestSP, Me.colRestSP_NextD, Me.colTimeSP, Me.colTimeSP_Next, Me.colStartDay, Me.colStartDay_PD, Me.colTimeEndDay, Me.colTimeEndDay_NextD, Me.colMon, Me.colTue, Me.colWed, Me.colThu, Me.colFri, Me.colSat, Me.colSun})
        Me.lstSubjectGroup.FullRowSelect = True
        Me.lstSubjectGroup.GridLines = True
        Me.lstSubjectGroup.Location = New System.Drawing.Point(2, 297)
        Me.lstSubjectGroup.Name = "lstSubjectGroup"
        Me.lstSubjectGroup.Size = New System.Drawing.Size(812, 239)
        Me.lstSubjectGroup.TabIndex = 9
        Me.lstSubjectGroup.UseCompatibleStateImageBehavior = False
        Me.lstSubjectGroup.View = System.Windows.Forms.View.Details
        '
        'colDeptId
        '
        Me.colDeptId.Text = "รหัส"
        '
        'colProgram
        '
        Me.colProgram.Text = "รอบการทำงาน"
        Me.colProgram.Width = 117
        '
        'colTimeST
        '
        Me.colTimeST.Text = "เวลาเข้า"
        Me.colTimeST.TextAlign = System.Windows.Forms.HorizontalAlignment.Center
        '
        'colRestST
        '
        Me.colRestST.Text = "พัก(เริ่ม)"
        Me.colRestST.TextAlign = System.Windows.Forms.HorizontalAlignment.Center
        '
        'colRestST_NextD
        '
        Me.colRestST_NextD.Text = "ขว."
        Me.colRestST_NextD.TextAlign = System.Windows.Forms.HorizontalAlignment.Center
        Me.colRestST_NextD.Width = 30
        '
        'colRestSP
        '
        Me.colRestSP.Text = "พัก(ถึง)"
        Me.colRestSP.TextAlign = System.Windows.Forms.HorizontalAlignment.Center
        '
        'colRestSP_NextD
        '
        Me.colRestSP_NextD.Text = "ขว."
        Me.colRestSP_NextD.TextAlign = System.Windows.Forms.HorizontalAlignment.Center
        Me.colRestSP_NextD.Width = 30
        '
        'colTimeSP
        '
        Me.colTimeSP.Text = "เวลาออก"
        Me.colTimeSP.TextAlign = System.Windows.Forms.HorizontalAlignment.Center
        '
        'colTimeSP_Next
        '
        Me.colTimeSP_Next.Text = "ขว."
        Me.colTimeSP_Next.TextAlign = System.Windows.Forms.HorizontalAlignment.Center
        Me.colTimeSP_Next.Width = 30
        '
        'colTimeEndDay
        '
        Me.colTimeEndDay.Text = "สิ้นสุดวัน"
        Me.colTimeEndDay.TextAlign = System.Windows.Forms.HorizontalAlignment.Center
        Me.colTimeEndDay.Width = 69
        '
        'colTimeEndDay_NextD
        '
        Me.colTimeEndDay_NextD.Text = "ขว."
        Me.colTimeEndDay_NextD.TextAlign = System.Windows.Forms.HorizontalAlignment.Center
        Me.colTimeEndDay_NextD.Width = 37
        '
        'colMon
        '
        Me.colMon.Text = "จ."
        Me.colMon.TextAlign = System.Windows.Forms.HorizontalAlignment.Center
        Me.colMon.Width = 40
        '
        'colTue
        '
        Me.colTue.Text = "อ."
        Me.colTue.TextAlign = System.Windows.Forms.HorizontalAlignment.Center
        Me.colTue.Width = 40
        '
        'colWed
        '
        Me.colWed.Text = "พ."
        Me.colWed.TextAlign = System.Windows.Forms.HorizontalAlignment.Center
        Me.colWed.Width = 40
        '
        'colThu
        '
        Me.colThu.Text = "พฤ."
        Me.colThu.TextAlign = System.Windows.Forms.HorizontalAlignment.Center
        Me.colThu.Width = 40
        '
        'colFri
        '
        Me.colFri.Text = "ศ."
        Me.colFri.TextAlign = System.Windows.Forms.HorizontalAlignment.Center
        Me.colFri.Width = 40
        '
        'colSat
        '
        Me.colSat.Text = "ส."
        Me.colSat.TextAlign = System.Windows.Forms.HorizontalAlignment.Center
        Me.colSat.Width = 40
        '
        'colSun
        '
        Me.colSun.Text = "อา."
        Me.colSun.TextAlign = System.Windows.Forms.HorizontalAlignment.Center
        Me.colSun.Width = 40
        '
        'btnAdd
        '
        Me.btnAdd.FlatStyle = System.Windows.Forms.FlatStyle.System
        Me.btnAdd.Location = New System.Drawing.Point(0, 263)
        Me.btnAdd.Name = "btnAdd"
        Me.btnAdd.Size = New System.Drawing.Size(62, 28)
        Me.btnAdd.TabIndex = 4
        Me.btnAdd.Text = "เพิ่ม"
        '
        'btnEdit
        '
        Me.btnEdit.FlatStyle = System.Windows.Forms.FlatStyle.System
        Me.btnEdit.Location = New System.Drawing.Point(62, 263)
        Me.btnEdit.Name = "btnEdit"
        Me.btnEdit.Size = New System.Drawing.Size(62, 28)
        Me.btnEdit.TabIndex = 5
        Me.btnEdit.Text = "แก้ไข"
        '
        'btnDelete
        '
        Me.btnDelete.FlatStyle = System.Windows.Forms.FlatStyle.System
        Me.btnDelete.Location = New System.Drawing.Point(124, 263)
        Me.btnDelete.Name = "btnDelete"
        Me.btnDelete.Size = New System.Drawing.Size(62, 28)
        Me.btnDelete.TabIndex = 6
        Me.btnDelete.Text = "ลบ"
        '
        'btnRefresh
        '
        Me.btnRefresh.FlatStyle = System.Windows.Forms.FlatStyle.System
        Me.btnRefresh.Location = New System.Drawing.Point(188, 263)
        Me.btnRefresh.Name = "btnRefresh"
        Me.btnRefresh.Size = New System.Drawing.Size(62, 28)
        Me.btnRefresh.TabIndex = 7
        Me.btnRefresh.Text = "Refresh"
        '
        'btnExit
        '
        Me.btnExit.FlatStyle = System.Windows.Forms.FlatStyle.System
        Me.btnExit.Location = New System.Drawing.Point(250, 263)
        Me.btnExit.Name = "btnExit"
        Me.btnExit.Size = New System.Drawing.Size(62, 28)
        Me.btnExit.TabIndex = 8
        Me.btnExit.Text = "ออก"
        '
        'txtTimeST
        '
        Me.txtTimeST.Location = New System.Drawing.Point(112, 19)
        Me.txtTimeST.Mask = "00:00"
        Me.txtTimeST.Name = "txtTimeST"
        Me.txtTimeST.Size = New System.Drawing.Size(50, 20)
        Me.txtTimeST.TabIndex = 0
        Me.txtTimeST.ValidatingType = GetType(Date)
        '
        'Label3
        '
        Me.Label3.Location = New System.Drawing.Point(26, 22)
        Me.Label3.Name = "Label3"
        Me.Label3.Size = New System.Drawing.Size(81, 16)
        Me.Label3.TabIndex = 0
        Me.Label3.Text = "เวลาเข้า : "
        Me.Label3.TextAlign = System.Drawing.ContentAlignment.TopRight
        '
        'Label4
        '
        Me.Label4.Location = New System.Drawing.Point(26, 97)
        Me.Label4.Name = "Label4"
        Me.Label4.Size = New System.Drawing.Size(81, 16)
        Me.Label4.TabIndex = 0
        Me.Label4.Text = "เวลาออก : "
        Me.Label4.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        '
        'txtTimeSP
        '
        Me.txtTimeSP.Location = New System.Drawing.Point(113, 97)
        Me.txtTimeSP.Mask = "00:00"
        Me.txtTimeSP.Name = "txtTimeSP"
        Me.txtTimeSP.Size = New System.Drawing.Size(50, 20)
        Me.txtTimeSP.TabIndex = 1
        Me.txtTimeSP.ValidatingType = GetType(Date)
        '
        'Label8
        '
        Me.Label8.AutoSize = True
        Me.Label8.ForeColor = System.Drawing.Color.RoyalBlue
        Me.Label8.Location = New System.Drawing.Point(12, 240)
        Me.Label8.Name = "Label8"
        Me.Label8.Size = New System.Drawing.Size(236, 13)
        Me.Label8.TabIndex = 11
        Me.Label8.Text = "หมายเหตุ : ติ๊กถูกคือวันมาทำงาน ไม่ติ๊กคือวันหยุด"
        '
        'GroupBox1
        '
        Me.GroupBox1.Controls.Add(Me.chkSunday)
        Me.GroupBox1.Controls.Add(Me.chkSaturday)
        Me.GroupBox1.Controls.Add(Me.chkFriday)
        Me.GroupBox1.Controls.Add(Me.chkThursday)
        Me.GroupBox1.Controls.Add(Me.chkWednesday)
        Me.GroupBox1.Controls.Add(Me.chkTuesday)
        Me.GroupBox1.Controls.Add(Me.chkMonDay)
        Me.GroupBox1.Location = New System.Drawing.Point(4, 180)
        Me.GroupBox1.Name = "GroupBox1"
        Me.GroupBox1.Size = New System.Drawing.Size(435, 53)
        Me.GroupBox1.TabIndex = 3
        Me.GroupBox1.TabStop = False
        Me.GroupBox1.Text = "กำหนดวันมาทำงานภายใน 1 อาทิตย์"
        '
        'chkSunday
        '
        Me.chkSunday.AutoSize = True
        Me.chkSunday.Location = New System.Drawing.Point(358, 28)
        Me.chkSunday.Name = "chkSunday"
        Me.chkSunday.Size = New System.Drawing.Size(58, 17)
        Me.chkSunday.TabIndex = 6
        Me.chkSunday.Text = "อาทิตย์"
        Me.chkSunday.UseVisualStyleBackColor = True
        '
        'chkSaturday
        '
        Me.chkSaturday.AutoSize = True
        Me.chkSaturday.Location = New System.Drawing.Point(299, 28)
        Me.chkSaturday.Name = "chkSaturday"
        Me.chkSaturday.Size = New System.Drawing.Size(48, 17)
        Me.chkSaturday.TabIndex = 5
        Me.chkSaturday.Text = "เสาร์"
        Me.chkSaturday.UseVisualStyleBackColor = True
        '
        'chkFriday
        '
        Me.chkFriday.AutoSize = True
        Me.chkFriday.Location = New System.Drawing.Point(246, 28)
        Me.chkFriday.Name = "chkFriday"
        Me.chkFriday.Size = New System.Drawing.Size(47, 17)
        Me.chkFriday.TabIndex = 4
        Me.chkFriday.Text = "ศุกร์"
        Me.chkFriday.UseVisualStyleBackColor = True
        '
        'chkThursday
        '
        Me.chkThursday.AutoSize = True
        Me.chkThursday.Location = New System.Drawing.Point(172, 28)
        Me.chkThursday.Name = "chkThursday"
        Me.chkThursday.Size = New System.Drawing.Size(68, 17)
        Me.chkThursday.TabIndex = 3
        Me.chkThursday.Text = "พฤหัสบดี"
        Me.chkThursday.UseVisualStyleBackColor = True
        '
        'chkWednesday
        '
        Me.chkWednesday.AutoSize = True
        Me.chkWednesday.Location = New System.Drawing.Point(131, 28)
        Me.chkWednesday.Name = "chkWednesday"
        Me.chkWednesday.Size = New System.Drawing.Size(40, 17)
        Me.chkWednesday.TabIndex = 2
        Me.chkWednesday.Text = "พุธ"
        Me.chkWednesday.UseVisualStyleBackColor = True
        '
        'chkTuesday
        '
        Me.chkTuesday.AutoSize = True
        Me.chkTuesday.Location = New System.Drawing.Point(70, 28)
        Me.chkTuesday.Name = "chkTuesday"
        Me.chkTuesday.Size = New System.Drawing.Size(55, 17)
        Me.chkTuesday.TabIndex = 1
        Me.chkTuesday.Text = "อังคาร"
        Me.chkTuesday.UseVisualStyleBackColor = True
        '
        'chkMonDay
        '
        Me.chkMonDay.AutoSize = True
        Me.chkMonDay.Location = New System.Drawing.Point(11, 28)
        Me.chkMonDay.Name = "chkMonDay"
        Me.chkMonDay.Size = New System.Drawing.Size(53, 17)
        Me.chkMonDay.TabIndex = 0
        Me.chkMonDay.Text = "จันทร์"
        Me.chkMonDay.UseVisualStyleBackColor = True
        '
        'GroupBox2
        '
        Me.GroupBox2.Controls.Add(Me.GroupBox3)
        Me.GroupBox2.Controls.Add(Me.chkMidDayStart_NextDay)
        Me.GroupBox2.Controls.Add(Me.chkMidDayStop_NextDay)
        Me.GroupBox2.Controls.Add(Me.chkTimeSP_NextDay)
        Me.GroupBox2.Controls.Add(Me.txtMidDayStop)
        Me.GroupBox2.Controls.Add(Me.txtMidDayStart)
        Me.GroupBox2.Controls.Add(Me.Label6)
        Me.GroupBox2.Controls.Add(Me.Label5)
        Me.GroupBox2.Controls.Add(Me.txtTimeST)
        Me.GroupBox2.Controls.Add(Me.Label3)
        Me.GroupBox2.Controls.Add(Me.Label4)
        Me.GroupBox2.Controls.Add(Me.txtTimeSP)
        Me.GroupBox2.Location = New System.Drawing.Point(4, 52)
        Me.GroupBox2.Name = "GroupBox2"
        Me.GroupBox2.Size = New System.Drawing.Size(698, 122)
        Me.GroupBox2.TabIndex = 2
        Me.GroupBox2.TabStop = False
        Me.GroupBox2.Text = "เวลา เข้า - ออก"
        '
        'txtEndDay
        '
        Me.txtEndDay.Location = New System.Drawing.Point(69, 60)
        Me.txtEndDay.Mask = "00:00"
        Me.txtEndDay.Name = "txtEndDay"
        Me.txtEndDay.Size = New System.Drawing.Size(51, 20)
        Me.txtEndDay.TabIndex = 2
        Me.txtEndDay.ValidatingType = GetType(Date)
        '
        'Label7
        '
        Me.Label7.AutoSize = True
        Me.Label7.Location = New System.Drawing.Point(6, 63)
        Me.Label7.Name = "Label7"
        Me.Label7.Size = New System.Drawing.Size(57, 13)
        Me.Label7.TabIndex = 11
        Me.Label7.Text = "สิ้นสุดวัน : "
        '
        'chkMidDayStart_NextDay
        '
        Me.chkMidDayStart_NextDay.AutoSize = True
        Me.chkMidDayStart_NextDay.Location = New System.Drawing.Point(169, 48)
        Me.chkMidDayStart_NextDay.Name = "chkMidDayStart_NextDay"
        Me.chkMidDayStart_NextDay.Size = New System.Drawing.Size(58, 17)
        Me.chkMidDayStart_NextDay.TabIndex = 4
        Me.chkMidDayStart_NextDay.Text = "ข้ามวัน"
        Me.chkMidDayStart_NextDay.UseVisualStyleBackColor = True
        '
        'chkMidDayStop_NextDay
        '
        Me.chkMidDayStop_NextDay.AutoSize = True
        Me.chkMidDayStop_NextDay.Location = New System.Drawing.Point(169, 73)
        Me.chkMidDayStop_NextDay.Name = "chkMidDayStop_NextDay"
        Me.chkMidDayStop_NextDay.Size = New System.Drawing.Size(58, 17)
        Me.chkMidDayStop_NextDay.TabIndex = 6
        Me.chkMidDayStop_NextDay.Text = "ข้ามวัน"
        Me.chkMidDayStop_NextDay.UseVisualStyleBackColor = True
        '
        'chkTimeEndDay_NextDay
        '
        Me.chkTimeEndDay_NextDay.AutoSize = True
        Me.chkTimeEndDay_NextDay.Location = New System.Drawing.Point(126, 63)
        Me.chkTimeEndDay_NextDay.Name = "chkTimeEndDay_NextDay"
        Me.chkTimeEndDay_NextDay.Size = New System.Drawing.Size(58, 17)
        Me.chkTimeEndDay_NextDay.TabIndex = 3
        Me.chkTimeEndDay_NextDay.Text = "ข้ามวัน"
        Me.chkTimeEndDay_NextDay.UseVisualStyleBackColor = True
        '
        'chkTimeSP_NextDay
        '
        Me.chkTimeSP_NextDay.AutoSize = True
        Me.chkTimeSP_NextDay.Location = New System.Drawing.Point(169, 100)
        Me.chkTimeSP_NextDay.Name = "chkTimeSP_NextDay"
        Me.chkTimeSP_NextDay.Size = New System.Drawing.Size(58, 17)
        Me.chkTimeSP_NextDay.TabIndex = 2
        Me.chkTimeSP_NextDay.Text = "ข้ามวัน"
        Me.chkTimeSP_NextDay.UseVisualStyleBackColor = True
        '
        'txtMidDayStop
        '
        Me.txtMidDayStop.Location = New System.Drawing.Point(112, 71)
        Me.txtMidDayStop.Mask = "00:00"
        Me.txtMidDayStop.Name = "txtMidDayStop"
        Me.txtMidDayStop.Size = New System.Drawing.Size(51, 20)
        Me.txtMidDayStop.TabIndex = 5
        Me.txtMidDayStop.ValidatingType = GetType(Date)
        '
        'txtMidDayStart
        '
        Me.txtMidDayStart.Location = New System.Drawing.Point(112, 45)
        Me.txtMidDayStart.Mask = "00:00"
        Me.txtMidDayStart.Name = "txtMidDayStart"
        Me.txtMidDayStart.Size = New System.Drawing.Size(51, 20)
        Me.txtMidDayStart.TabIndex = 3
        Me.txtMidDayStart.ValidatingType = GetType(Date)
        '
        'Label6
        '
        Me.Label6.Location = New System.Drawing.Point(26, 74)
        Me.Label6.Name = "Label6"
        Me.Label6.Size = New System.Drawing.Size(81, 16)
        Me.Label6.TabIndex = 6
        Me.Label6.Text = "พักถึง : "
        Me.Label6.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        '
        'Label5
        '
        Me.Label5.Location = New System.Drawing.Point(26, 49)
        Me.Label5.Name = "Label5"
        Me.Label5.Size = New System.Drawing.Size(81, 16)
        Me.Label5.TabIndex = 5
        Me.Label5.Text = "เริ่มพัก : "
        Me.Label5.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        '
        'GroupBox3
        '
        Me.GroupBox3.Controls.Add(Me.Label9)
        Me.GroupBox3.Controls.Add(Me.txtStartDay)
        Me.GroupBox3.Controls.Add(Me.Label7)
        Me.GroupBox3.Controls.Add(Me.chkStartDay_PD)
        Me.GroupBox3.Controls.Add(Me.txtEndDay)
        Me.GroupBox3.Controls.Add(Me.chkTimeEndDay_NextDay)
        Me.GroupBox3.Location = New System.Drawing.Point(397, 16)
        Me.GroupBox3.Name = "GroupBox3"
        Me.GroupBox3.Size = New System.Drawing.Size(289, 97)
        Me.GroupBox3.TabIndex = 7
        Me.GroupBox3.TabStop = False
        Me.GroupBox3.Text = "รอบวันที่ใช้ในการคำนวณ"
        '
        'chkStartDay_PD
        '
        Me.chkStartDay_PD.AutoSize = True
        Me.chkStartDay_PD.Location = New System.Drawing.Point(126, 30)
        Me.chkStartDay_PD.Name = "chkStartDay_PD"
        Me.chkStartDay_PD.Size = New System.Drawing.Size(67, 17)
        Me.chkStartDay_PD.TabIndex = 1
        Me.chkStartDay_PD.Text = "ก่อนหน้า"
        Me.chkStartDay_PD.UseVisualStyleBackColor = True
        '
        'txtStartDay
        '
        Me.txtStartDay.Location = New System.Drawing.Point(69, 27)
        Me.txtStartDay.Mask = "00:00"
        Me.txtStartDay.Name = "txtStartDay"
        Me.txtStartDay.Size = New System.Drawing.Size(51, 20)
        Me.txtStartDay.TabIndex = 0
        Me.txtStartDay.ValidatingType = GetType(Date)
        '
        'Label9
        '
        Me.Label9.AutoSize = True
        Me.Label9.Location = New System.Drawing.Point(6, 29)
        Me.Label9.Name = "Label9"
        Me.Label9.Size = New System.Drawing.Size(48, 13)
        Me.Label9.TabIndex = 11
        Me.Label9.Text = "เริ่มวัน : "
        '
        'colStartDay
        '
        Me.colStartDay.Text = "เริ่มต้นวัน"
        Me.colStartDay.TextAlign = System.Windows.Forms.HorizontalAlignment.Center
        '
        'colStartDay_PD
        '
        Me.colStartDay_PD.Text = "กว."
        Me.colStartDay_PD.TextAlign = System.Windows.Forms.HorizontalAlignment.Center
        Me.colStartDay_PD.Width = 41
        '
        'frmTimeKa
        '
        Me.AutoScaleBaseSize = New System.Drawing.Size(5, 13)
        Me.BackColor = System.Drawing.SystemColors.Control
        Me.ClientSize = New System.Drawing.Size(818, 538)
        Me.Controls.Add(Me.GroupBox2)
        Me.Controls.Add(Me.Label8)
        Me.Controls.Add(Me.GroupBox1)
        Me.Controls.Add(Me.btnAdd)
        Me.Controls.Add(Me.lstSubjectGroup)
        Me.Controls.Add(Me.txtGroupId)
        Me.Controls.Add(Me.txtGroupName)
        Me.Controls.Add(Me.Label1)
        Me.Controls.Add(Me.Label2)
        Me.Controls.Add(Me.btnEdit)
        Me.Controls.Add(Me.btnDelete)
        Me.Controls.Add(Me.btnRefresh)
        Me.Controls.Add(Me.btnExit)
        Me.KeyPreview = True
        Me.Name = "frmTimeKa"
        Me.Text = "กำหนดเวลาทำงาน"
        Me.WindowState = System.Windows.Forms.FormWindowState.Maximized
        Me.GroupBox1.ResumeLayout(False)
        Me.GroupBox1.PerformLayout()
        Me.GroupBox2.ResumeLayout(False)
        Me.GroupBox2.PerformLayout()
        Me.GroupBox3.ResumeLayout(False)
        Me.GroupBox3.PerformLayout()
        Me.ResumeLayout(False)
        Me.PerformLayout()

    End Sub

#End Region

    Private Sub frmDepartment_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        Call ClearData()
        Call LoadData()
        Call EnaCmd(True, False, False)
        txtGroupId.Focus()
        'txtGroupName.Focus()

    End Sub

    Private Sub btnExit_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnExit.Click
        Me.Close()
    End Sub

    Private Sub ClearData()
        txtGroupId.Text = ""
        txtGroupName.Text = ""
        txtTimeST.Text = ""
        txtTimeSP.Text = ""
        txtStartDay.Text = ""
        txtEndDay.Text = ""

        txtMidDayStart.Text = ""
        txtMidDayStop.Text = ""


        chkMidDayStart_NextDay.Checked = False
        chkMidDayStop_NextDay.Checked = False
        chkTimeSP_NextDay.Checked = False
        chkStartDay_PD.Checked = False
        chkTimeEndDay_NextDay.Checked = False


        ' Clear DATE Of Week
        chkMonDay.Checked = False
        chkTuesday.Checked = False
        chkWednesday.Checked = False
        chkThursday.Checked = False
        chkFriday.Checked = False
        chkSaturday.Checked = False
        chkSunday.Checked = False
    End Sub

    Private Sub EnaCmd(ByVal Add As Boolean, ByVal Edit As Boolean, ByVal Delete As Boolean)
        btnAdd.Enabled = Add
        btnEdit.Enabled = Edit
        btnDelete.Enabled = Delete
    End Sub

    Private Sub LoadData()
        Dim DA As New SqlDataAdapter
        Dim Ds As New DataSet
        Dim strSQL As String
        strSQL = "Select KA_Code,KaName," & _
                            " TimeST,TimeSP,RestST,RestSP,StartDay,EndDay," & _
                            " RestST_ND = Isnull(RestST_ND,0)," & _
                            " RestSP_ND = Isnull(RestSP_ND,0)," & _
                            " TimeSP_ND = Isnull(TimeSP_ND,0)," & _
                            " StartDay_PD = Isnull(StartDay_PD,0)," & _
                            " EndDay_ND = Isnull(EndDay_ND,0)," & _
                            " Monday = Isnull(Monday,0)," & _
                            " Tuesday = Isnull(Tuesday,0)," & _
                            " Wednesday = Isnull(Wednesday,0)," & _
                            " Thursday = Isnull(Thursday,0)," & _
                            " Friday = Isnull(Friday,0)," & _
                            " Saturday = Isnull(Saturday,0)," & _
                            " Sunday = Isnull(Sunday,0) " & _
                " from TimeKa " & _
                " Order By TimeST"
        DA = New SqlDataAdapter(strSQL, Conn)
        DA.Fill(Ds, "TimeKa")
        With Ds.Tables("TimeKa")
            If .Rows.Count = 0 Then
                Ds.Clear()
                lstSubjectGroup.Items.Clear()
                Exit Sub
            End If
            Dim I As Integer
            Dim arrData() As String
            Dim List As ListViewItem
            lstSubjectGroup.Items.Clear()
            For I = 0 To .Rows.Count - 1
                arrData = New String() {.Rows(I).Item("KA_Code"), _
                                    .Rows(I).Item("KaName"), _
                                    Format(.Rows(I).Item("TimeST"), "HH:mm"), _
                                    Format(.Rows(I).Item("RestST"), "HH:mm"), _
                                    IIf(.Rows(I).Item("RestST_ND"), "/", ""), _
                                    Format(.Rows(I).Item("RestSP"), "HH:mm"), _
                                    IIf(.Rows(I).Item("RestSP_ND"), "/", ""), _
                                    Format(.Rows(I).Item("TimeSP"), "HH:mm"), _
                                    IIf(.Rows(I).Item("TimeSP_ND"), "/", ""), _
                                    Format(.Rows(I).Item("StartDay"), "HH:mm"), _
                                    IIf(.Rows(I).Item("StartDay_PD"), "/", ""), _
                                    Format(.Rows(I).Item("EndDay"), "HH:mm"), _
                                    IIf(.Rows(I).Item("EndDay_ND"), "/", ""), _
                                    IIf(.Rows(I).Item("Monday"), "x", ""), _
                                    IIf(.Rows(I).Item("Tuesday"), "x", ""), _
                                    IIf(.Rows(I).Item("Wednesday"), "x", ""), _
                                    IIf(.Rows(I).Item("Thursday"), "x", ""), _
                                    IIf(.Rows(I).Item("Friday"), "x", ""), _
                                    IIf(.Rows(I).Item("Saturday"), "x", ""), _
                                    IIf(.Rows(I).Item("Sunday"), "x", "")}
                List = New ListViewItem(arrData)
                lstSubjectGroup.Items.Add(List)
            Next
            Ds.Clear()
        End With
    End Sub

    Private Sub btnRefresh_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnRefresh.Click
        Call ClearData()
        Call LoadData()
        Call EnaCmd(True, False, False)
        'txtGroupId.Text = AutoId()
        txtGroupId.Focus()
    End Sub

    Private Sub txtGroupId_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles txtGroupId.TextChanged

    End Sub

    Private Sub txtGroupId_LostFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles txtGroupId.LostFocus
        Dim DA As New SqlDataAdapter
        Dim DS As New DataSet
        Dim strSQL As String
        strSQL = "Select KA_Code,KaName," & _
                            " TimeST,TimeSP," & _
                            " RestST,RestSP,StartDay,EndDay," & _
                            " RestST_ND = Isnull(RestST_ND,0)," & _
                            " RestSP_ND = Isnull(RestSP_ND,0)," & _
                            " TimeSP_ND = Isnull(TimeSP_ND,0)," & _
                            " StartDay_PD = Isnull(StartDay_PD,0)," & _
                            " EndDay_ND = Isnull(EndDay_ND,0)," & _
                            " Monday = Isnull(Monday,0)," & _
                            " Tuesday = Isnull(Tuesday,0)," & _
                            " Wednesday = Isnull(Wednesday,0)," & _
                            " Thursday = Isnull(Thursday,0)," & _
                            " Friday = Isnull(Friday,0)," & _
                            " Saturday = Isnull(Saturday,0)," & _
                            " Sunday = Isnull(Sunday,0) " & _
                " from TimeKa " & _
                " Where KA_Code = '" & txtGroupId.Text.Trim & "'"
        DA = New SqlDataAdapter(strSQL, Conn)
        DA.Fill(DS, "TimeKa")
        With DS.Tables("TimeKa")
            If .Rows.Count = 0 Then
                DS.Clear()
                txtGroupName.Text = ""
                Call EnaCmd(True, False, False)
                Exit Sub
            End If
            txtGroupName.Text = .Rows(0).Item("KaName")
            txtTimeST.Text = Format(.Rows(0).Item("TimeST"), "HH:mm")
            txtTimeSP.Text = Format(.Rows(0).Item("TimeSP"), "HH:mm")
            txtMidDayStart.Text = Format(.Rows(0).Item("RestST"), "HH:mm")
            txtMidDayStop.Text = Format(.Rows(0).Item("RestSP"), "HH:mm")
            txtStartDay.Text = Format(.Rows(0).Item("StartDay"), "HH:mm")
            txtEndDay.Text = Format(.Rows(0).Item("EndDay"), "HH:mm")

            If .Rows(0).Item("TimeSP_ND") = True Then
                chkTimeSP_NextDay.Checked = True
            Else
                chkTimeSP_NextDay.Checked = False
            End If

            If .Rows(0).Item("RestST_ND") = True Then
                chkMidDayStart_NextDay.Checked = True
            Else
                chkMidDayStart_NextDay.Checked = False
            End If

            If .Rows(0).Item("RestSP_ND") = True Then
                chkMidDayStop_NextDay.Checked = True
            Else
                chkMidDayStop_NextDay.Checked = False
            End If

            If .Rows(0).Item("StartDay_PD") = True Then
                chkStartDay_PD.Checked = True
            Else
                chkStartDay_PD.Checked = False
            End If

            If .Rows(0).Item("EndDay_ND") = True Then
                chkTimeEndDay_NextDay.Checked = True
            Else
                chkTimeEndDay_NextDay.Checked = False
            End If

            'Monday,Tuesday,Wednesday,Thursday,Friday,Saturday,Sunday
            If .Rows(0).Item("Monday") = True Then
                chkMonDay.Checked = True
            Else
                chkMonDay.Checked = False
            End If

            If .Rows(0).Item("Tuesday") = True Then
                chkTuesday.Checked = True
            Else
                chkTuesday.Checked = False
            End If

            If .Rows(0).Item("Wednesday") = True Then
                chkWednesday.Checked = True
            Else
                chkWednesday.Checked = False
            End If

            If .Rows(0).Item("Thursday") = True Then
                chkThursday.Checked = True
            Else
                chkThursday.Checked = False
            End If

            If .Rows(0).Item("Friday") = True Then
                chkFriday.Checked = True
            Else
                chkFriday.Checked = False
            End If

            If .Rows(0).Item("Saturday") = True Then
                chkSaturday.Checked = True
            Else
                chkSaturday.Checked = False
            End If

            If .Rows(0).Item("Sunday") = True Then
                chkSunday.Checked = True
            Else
                chkSunday.Checked = False
            End If

            DS.Clear()
            Call EnaCmd(False, True, True)
        End With
    End Sub

    Function AutoId() As String
        Dim DaAuto As New SqlDataAdapter
        Dim DsAuto As New DataSet
        Dim strSQL As String
        Dim Id As String
        strSQL = "Select Isnull(Max(KA_Code),'000') as MaxId From TimeKa Where Isnumeric(KA_Code) = 1"
        DaAuto = New SqlDataAdapter(strSQL, Conn)
        DaAuto.Fill(DsAuto, "MaxId")
        With DsAuto.Tables("MaxId")
            Id = Format(Val(.Rows(0).Item("MaxId")) + 1, "000")
        End With
        DsAuto.Clear()
        Return Id.Trim
    End Function



    Private Sub btnAdd_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnAdd.Click
        If txtGroupId.Text.Trim = "" Then
            MsgBox("กรุณาป้อนรหัสด้วย", MsgBoxStyle.Information, Me.Text)
            txtGroupId.Focus()
            Exit Sub
        End If
        If txtGroupName.Text.Trim = "" Then
            MsgBox("กรุณาป้อนชื่อรอบการทำงานด้วย", MsgBoxStyle.Information, Me.Text)
            txtGroupName.Focus()
            Exit Sub
        End If

        If IsDate("1900/01/01 " & txtTimeST.Text.Trim) = False Then
            MsgBox("กรุณาป้อนเวลาให้ถูกต้องด้วย", MsgBoxStyle.Information, Me.Text)
            txtTimeST.Focus()
            Exit Sub
        End If

        If IsDate("1900/01/01 " & txtTimeSP.Text.Trim) = False Then
            MsgBox("กรุณาป้อนเวลาให้ถูกต้องด้วย", MsgBoxStyle.Information, Me.Text)
            txtTimeSP.Focus()
            Exit Sub
        End If

        If IsDate("1900/01/01 " & txtStartDay.Text.Trim) = False Then
            MsgBox("กรุณาป้อนเวลาให้ถูกต้องด้วย", MsgBoxStyle.Information, Me.Text)
            txtStartDay.Focus()
            Exit Sub
        End If

        If IsDate("1900/01/01 " & txtEndDay.Text.Trim) = False Then
            MsgBox("กรุณาป้อนเวลาให้ถูกต้องด้วย", MsgBoxStyle.Information, Me.Text)
            txtEndDay.Focus()
            Exit Sub
        End If

        If IsDate("1900/01/01 " & txtMidDayStart.Text.Trim) = False Then
            MsgBox("กรุณาป้อนเวลาให้ถูกต้องด้วย", MsgBoxStyle.Information, Me.Text)
            txtMidDayStart.Focus()
            Exit Sub
        End If

        If IsDate("1900/01/01 " & txtMidDayStop.Text.Trim) = False Then
            MsgBox("กรุณาป้อนเวลาให้ถูกต้องด้วย", MsgBoxStyle.Information, Me.Text)
            txtMidDayStop.Focus()
            Exit Sub
        End If

        Dim Dcmd As New SqlCommand
        Dim strSQL As String
        Try
            strSQL = "Insert Into TimeKa(KA_Code,KaName," & _
                            " TimeST,TimeSP,RestST,RestSP,StartDay,EndDay," & _
                            " TimeSP_ND,RestST_ND,RestSP_ND,StartDay_PD,EndDay_ND," & _
                            " Monday,Tuesday,Wednesday,Thursday,Friday,Saturday,Sunday) Values(" & _
                     "'" & txtGroupId.Text.Trim & "','" & txtGroupName.Text.Trim & "'," & _
                     "'" & txtTimeST.Text.Trim & "','" & txtTimeSP.Text.Trim & "'," & _
                     "'" & txtMidDayStart.Text.Trim & "','" & txtMidDayStop.Text.Trim & "'," & _
                     "'" & txtStartDay.Text.Trim & "'," & _
                     "'" & txtEndDay.Text.Trim & "'," & _
                     " " & IIf(chkMidDayStart_NextDay.Checked = True, 1, 0) & "," & _
                     " " & IIf(chkMidDayStop_NextDay.Checked = True, 1, 0) & "," & _
                     " " & IIf(chkTimeSP_NextDay.Checked = True, 1, 0) & "," & _
                     " " & IIf(chkStartDay_PD.Checked = True, 1, 0) & "," & _
                     " " & IIf(chkTimeEndDay_NextDay.Checked = True, 1, 0) & "," & _
                     " " & IIf(chkMonDay.Checked = True, 1, 0) & "," & _
                     " " & IIf(chkTuesday.Checked = True, 1, 0) & "," & _
                     " " & IIf(chkWednesday.Checked = True, 1, 0) & "," & _
                     " " & IIf(chkThursday.Checked = True, 1, 0) & "," & _
                     " " & IIf(chkFriday.Checked = True, 1, 0) & "," & _
                     " " & IIf(chkSaturday.Checked = True, 1, 0) & "," & _
                     " " & IIf(chkSunday.Checked = True, 1, 0) & ")"
            Dcmd.Connection = Conn
            Dcmd.CommandText = strSQL
            Dcmd.ExecuteNonQuery()
        Catch ex As Exception
            MsgBox(ex.Message, MsgBoxStyle.Exclamation, Me.Text)
            Exit Sub
        End Try
        Call btnRefresh_Click(Me, System.EventArgs.Empty)
    End Sub

    Private Sub txtGroupName_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles txtGroupName.GotFocus
        txtGroupName.SelectAll()
    End Sub

    Private Sub lstSubjectGroup_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles lstSubjectGroup.SelectedIndexChanged
        With lstSubjectGroup
            If .Items.Count = 0 Then Exit Sub
            If .SelectedItems.Count = 0 Then Exit Sub
            txtGroupId.Text = .SelectedItems(0).SubItems(0).Text.Trim
            Call txtGroupId_LostFocus(Me, System.EventArgs.Empty)
            txtGroupName.Focus()
            Call EnaCmd(False, True, True)
        End With
    End Sub

    Private Sub btnEdit_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnEdit.Click
        If txtGroupName.Text.Trim = "" Then
            MsgBox("กรุณาป้อนชื่อแผนด้วย", MsgBoxStyle.Information, Me.Text)
            txtGroupName.Focus()
            Exit Sub
        End If
        If IsDate("1900/01/01 " & txtTimeST.Text.Trim) = False Then
            MsgBox("กรุณาป้อนเวลาให้ถูกต้องด้วย", MsgBoxStyle.Information, Me.Text)
            txtTimeST.Focus()
            Exit Sub
        End If

        If IsDate("1900/01/01 " & txtTimeSP.Text.Trim) = False Then
            MsgBox("กรุณาป้อนเวลาให้ถูกต้องด้วย", MsgBoxStyle.Information, Me.Text)
            txtTimeSP.Focus()
            Exit Sub
        End If

        If IsDate("1900/01/01 " & txtStartDay.Text.Trim) = False Then
            MsgBox("กรุณาป้อนเวลาให้ถูกต้องด้วย", MsgBoxStyle.Information, Me.Text)
            txtStartDay.Focus()
            Exit Sub
        End If

        If IsDate("1900/01/01 " & txtEndDay.Text.Trim) = False Then
            MsgBox("กรุณาป้อนเวลาให้ถูกต้องด้วย", MsgBoxStyle.Information, Me.Text)
            txtEndDay.Focus()
            Exit Sub
        End If

        If IsDate("1900/01/01 " & txtMidDayStart.Text.Trim) = False Then
            MsgBox("กรุณาป้อนเวลาให้ถูกต้องด้วย", MsgBoxStyle.Information, Me.Text)
            txtMidDayStart.Focus()
            Exit Sub
        End If

        If IsDate("1900/01/01 " & txtMidDayStop.Text.Trim) = False Then
            MsgBox("กรุณาป้อนเวลาให้ถูกต้องด้วย", MsgBoxStyle.Information, Me.Text)
            txtMidDayStop.Focus()
            Exit Sub
        End If

        Dim Dcmd As New SqlCommand
        Dim strSQL As String
        Try
            strSQL = "Update TimeKa Set KaName = '" & txtGroupName.Text.Trim & "'" & _
                                        " ,TimeST = '" & txtTimeST.Text.Trim & "'" & _
                                        " ,TimeSP = '" & txtTimeSP.Text.Trim & "'" & _
                                        " ,RestST = '" & txtMidDayStart.Text.Trim & "'" & _
                                        " ,RestSP = '" & txtMidDayStop.Text.Trim & "'" & _
                                        " ,StartDay = '" & txtStartDay.Text.Trim & "'" & _
                                        " ,EndDay = '" & txtEndDay.Text.Trim & "'" & _
                                        " ,RestST_ND = " & IIf(chkMidDayStart_NextDay.Checked = True, 1, 0) & _
                                        " ,RestSP_ND = " & IIf(chkMidDayStop_NextDay.Checked = True, 1, 0) & _
                                        " ,TimeSP_ND = " & IIf(chkTimeSP_NextDay.Checked = True, 1, 0) & _
                                        " ,StartDay_PD = " & IIf(chkStartDay_PD.Checked = True, 1, 0) & _
                                        " ,EndDay_ND = " & IIf(chkTimeEndDay_NextDay.Checked = True, 1, 0) & _
                                        " ,Monday = " & IIf(chkMonDay.Checked = True, 1, 0) & _
                                        " ,Tuesday = " & IIf(chkTuesday.Checked = True, 1, 0) & _
                                        " ,Wednesday = " & IIf(chkWednesday.Checked = True, 1, 0) & _
                                        " ,Thursday = " & IIf(chkThursday.Checked = True, 1, 0) & _
                                        " ,Friday = " & IIf(chkFriday.Checked = True, 1, 0) & _
                                        " ,Saturday = " & IIf(chkSaturday.Checked = True, 1, 0) & _
                                        " ,Sunday =" & IIf(chkSunday.Checked = True, 1, 0) & _
                    " Where KA_Code = '" & txtGroupId.Text.Trim & "'"
            Dcmd.Connection = Conn
            Dcmd.CommandText = strSQL
            Dcmd.ExecuteNonQuery()
        Catch ex As Exception
            MsgBox(ex.Message, MsgBoxStyle.Exclamation, Me.Text)
            Exit Sub
        End Try
        Call btnRefresh_Click(Me, System.EventArgs.Empty)
    End Sub

    Private Sub btnDelete_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnDelete.Click
        Dim Dcmd As New SqlCommand
        Dim strSQL As String
        If MsgBox("คุณต้องการลบข้อมูลนี้หรือไม่", MsgBoxStyle.Information + MsgBoxStyle.YesNo, Me.Text) = MsgBoxResult.No Then Exit Sub
        'If IsUse(txtGroupId.Text.Trim) = True Then
        '    MsgBox("ข้อมูลนี้ไฟล์ข้อมูลพนักงานใช้งานอยู่ไม่สามารถลบได้", MsgBoxStyle.Information, Me.Text)
        '    Exit Sub
        'End If
        Try
            strSQL = "Delete From TimeKa Where KA_Code = '" & txtGroupId.Text.Trim & "'"
            Dcmd.Connection = Conn
            Dcmd.CommandText = strSQL
            Dcmd.ExecuteNonQuery()
        Catch ex As Exception
            MsgBox(ex.Message, MsgBoxStyle.Exclamation, Me.Text)
            Exit Sub
        End Try
        Call btnRefresh_Click(Me, System.EventArgs.Empty)
    End Sub

    Function IsUse(ByVal GroupId As String) As Boolean
        Dim DA As New SqlDataAdapter
        Dim DS As New DataSet
        Dim strSQL As String
        Dim Use As Boolean
        strSQL = "Select Code From Emp Where KA_Code = '" & GroupId.Trim & "'"
        DA = New SqlDataAdapter(strSQL, Conn)
        DA.Fill(DS, "Emp")
        If DS.Tables("Emp").Rows.Count = 0 Then
            Use = False
        Else
            Use = True
        End If
        DS.Clear()
        Return Use
    End Function

    Private Sub frmSubjectGroup_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles MyBase.KeyPress
        On Error Resume Next
        If Asc(e.KeyChar) = 13 Then
            'If e.KeyChar = Microsoft.VisualBasic.ChrW(Keys.Enter) Then
            If TypeOf Me.ActiveControl Is TextBox Then
                Dim tb As TextBox = DirectCast(Me.ActiveControl, TextBox)
                If tb.Multiline AndAlso tb.AcceptsReturn Then
                    e.Handled = False
                    Exit Sub
                End If
            End If
            e.Handled = True
            Dim oform As Form = Me.FindForm
            oform.SelectNextControl(oform.ActiveControl, True, True, True, True)
            oform.ActiveControl.Focus()
        End If
    End Sub

    Private Sub chkMidDayStart_NextDay_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles chkMidDayStart_NextDay.CheckedChanged
        If chkMidDayStart_NextDay.Checked = True Then
            chkMidDayStop_NextDay.Checked = True
            chkTimeSP_NextDay.Checked = True
            chkTimeEndDay_NextDay.Checked = True

            chkMidDayStop_NextDay.Enabled = False
            chkTimeSP_NextDay.Enabled = False
            chkTimeEndDay_NextDay.Enabled = False
        Else
            chkMidDayStop_NextDay.Checked = False
            chkTimeSP_NextDay.Checked = False
            chkTimeEndDay_NextDay.Checked = False

            chkMidDayStop_NextDay.Enabled = True
            chkTimeSP_NextDay.Enabled = True
            chkTimeEndDay_NextDay.Enabled = True
        End If
    End Sub

    Private Sub chkMidDayStop_NextDay_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles chkMidDayStop_NextDay.CheckedChanged
        If chkMidDayStop_NextDay.Checked = True Then
            chkTimeSP_NextDay.Checked = True
            chkTimeEndDay_NextDay.Checked = True

            chkTimeSP_NextDay.Enabled = False
            chkTimeEndDay_NextDay.Enabled = False
        Else
            chkTimeSP_NextDay.Checked = False
            chkTimeEndDay_NextDay.Checked = False

            chkTimeSP_NextDay.Enabled = True
            chkTimeEndDay_NextDay.Enabled = True
        End If
    End Sub

    Private Sub chkTimeSP_NextDay_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles chkTimeSP_NextDay.CheckedChanged
        If chkTimeSP_NextDay.Checked = True Then
            chkTimeEndDay_NextDay.Checked = True

            chkTimeEndDay_NextDay.Enabled = False
        Else
            chkTimeEndDay_NextDay.Checked = False

            chkTimeEndDay_NextDay.Enabled = True
        End If
    End Sub

    Private Sub txtStartDay_MaskInputRejected(ByVal sender As System.Object, ByVal e As System.Windows.Forms.MaskInputRejectedEventArgs) Handles txtStartDay.MaskInputRejected

    End Sub
End Class
